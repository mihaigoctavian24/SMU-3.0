@* StatsCard.razor - Reusable stats card component for dashboards using Radzen *@

<RadzenCard Style="padding: 1.5rem; height: 100%;">
    <RadzenStack Orientation="Radzen.Orientation.Horizontal" JustifyContent="JustifyContent.SpaceBetween" AlignItems="AlignItems.Start">
        <RadzenStack Gap="0.5rem" Style="flex: 1;">
            <RadzenText TextStyle="TextStyle.Overline" class="rz-color-secondary" Style="margin: 0;">@Label</RadzenText>
            <RadzenText TextStyle="TextStyle.H3" Style="margin: 0; font-weight: 700;">@Value</RadzenText>
            @if (!string.IsNullOrEmpty(Subtitle))
            {
                <RadzenText TextStyle="TextStyle.Body2" class="rz-color-secondary" Style="margin: 0;">@Subtitle</RadzenText>
            }
            @if (ShowTrend && TrendValue != 0)
            {
                <RadzenStack Orientation="Radzen.Orientation.Horizontal" AlignItems="AlignItems.Center" Gap="0.25rem">
                    @if (TrendValue > 0)
                    {
                        <RadzenIcon Icon="trending_up" Style="color: var(--rz-success); font-size: 16px;" />
                        <RadzenText TextStyle="TextStyle.Caption" Style="margin: 0; color: var(--rz-success); font-weight: 500;">
                            +@TrendValue.ToString("0.#")%
                        </RadzenText>
                    }
                    else
                    {
                        <RadzenIcon Icon="trending_down" Style="color: var(--rz-danger); font-size: 16px;" />
                        <RadzenText TextStyle="TextStyle.Caption" Style="margin: 0; color: var(--rz-danger); font-weight: 500;">
                            @TrendValue.ToString("0.#")%
                        </RadzenText>
                    }
                    <RadzenText TextStyle="TextStyle.Caption" class="rz-color-secondary" Style="margin: 0;">vs luna trecută</RadzenText>
                </RadzenStack>
            }
        </RadzenStack>
        <RadzenStack AlignItems="AlignItems.Center" JustifyContent="JustifyContent.Center"
                     Style="@($"width: 56px; height: 56px; border-radius: 12px; background: {GetIconBg()};")">
            @if (IconContent != null)
            {
                @IconContent
            }
            else
            {
                <RadzenIcon Icon="@GetMaterialIcon()" Style="@($"font-size: 28px; color: {GetIconColor()};")" />
            }
        </RadzenStack>
    </RadzenStack>
    @if (!string.IsNullOrEmpty(ActionLink) && !string.IsNullOrEmpty(ActionText))
    {
        <RadzenStack Style="margin-top: 1rem; padding-top: 1rem; border-top: 1px solid var(--rz-base-300);">
            <RadzenLink Path="@ActionLink" Text="@ActionText" Icon="chevron_right" Style="font-weight: 500;" />
        </RadzenStack>
    }
</RadzenCard>

@code {
    [Parameter] public string Label { get; set; } = "Statistică";
    [Parameter] public string Value { get; set; } = "0";
    [Parameter] public string? Subtitle { get; set; }
    [Parameter] public bool ShowTrend { get; set; }
    [Parameter] public decimal TrendValue { get; set; }
    [Parameter] public string IconType { get; set; } = "chart"; // chart, users, grades, attendance, calendar, document, bell, settings
    [Parameter] public string IconBgClass { get; set; } = "bg-primary-100";
    [Parameter] public string IconClass { get; set; } = "text-primary-600";
    [Parameter] public RenderFragment? IconContent { get; set; }
    [Parameter] public string? ActionLink { get; set; }
    [Parameter] public string? ActionText { get; set; }

    private string GetMaterialIcon() => IconType switch
    {
        "users" => "group",
        "grades" => "assignment",
        "attendance" => "check_circle",
        "calendar" => "calendar_month",
        "document" => "description",
        "bell" => "notifications",
        "settings" => "settings",
        "book" => "menu_book",
        "academic" => "school",
        "warning" => "warning",
        _ => "bar_chart"
    };

    private string GetIconBg() => IconBgClass switch
    {
        "bg-success-100" => "rgba(34, 197, 94, 0.15)",
        "bg-primary-100" => "rgba(79, 70, 229, 0.15)",
        "bg-info-100" => "rgba(59, 130, 246, 0.15)",
        "bg-warning-100" => "rgba(245, 158, 11, 0.15)",
        "bg-danger-100" => "rgba(239, 68, 68, 0.15)",
        _ => "rgba(79, 70, 229, 0.15)"
    };

    private string GetIconColor() => IconClass switch
    {
        "text-success-600" => "var(--rz-success)",
        "text-primary-600" => "var(--rz-primary)",
        "text-info-600" => "var(--rz-info)",
        "text-warning-600" => "var(--rz-warning)",
        "text-danger-600" => "var(--rz-danger)",
        _ => "var(--rz-primary)"
    };
}
